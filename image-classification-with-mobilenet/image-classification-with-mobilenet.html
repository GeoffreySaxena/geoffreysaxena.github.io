<!DOCTYPE html>
<html lang="en-US">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>
    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon-->
    <link rel="shortcut icon" href="../images/favicon.png">
    <!-- Author Meta -->
    <meta name="author" content="Pratik Geoffrey Saxena">
    <!-- Meta Description -->
    <meta name="description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <!-- Meta Keyword -->
    <meta name="keywords" content="portfolio">
    <!-- meta character set -->
    <meta charset="UTF-8">
    <!-- Site Title -->
    <title>Image Classification with MobileNet</title>

    <link rel="stylesheet" href="../css/wpmin.css" media="all" data-minify="1" />

    <link rel='stylesheet' href='../css/main.css' type='text/css' media='all' />

    <link rel='dns-prefetch' href='http://fonts.googleapis.com/' />

    <link href='https://fonts.gstatic.com/' crossorigin rel='preconnect' />

    <link rel='stylesheet' id='collecto-google-font-enqueue-css' href='https://fonts.googleapis.com/css?family=Hepta+Slab:200,400,700&amp;subset=latin%2Clatin-ext&amp;display=swap' type='text/css' media='all' />

    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
    <script type='text/javascript' src='../js/jquery.js' id='jquery-core-js'></script>
    <script type='text/javascript' src='../js/main.js'></script>
</head>


<body class="post-template-default single single-post postid-117 single-format-standard tk-theme-frontend">

    <body class="home blog hfeed tk-theme-frontend">
        <div id="page" class="site">
            <a class="skip-link screen-reader-text" href="#content">Skip to content</a>

            <header id="masthead" class="site-header" role="banner">
                <div class="site-branding">

                    <h1 class="site-title"><a href="../index.html" rel="home">curious.analyst</a></h1>
                </div><!-- .site-branding -->
            </header><!-- #masthead -->

            <div class="primary-side theme-side">
                <div class="sidebar-button">
                    <button class="sidebar-toggle">
                        <span class="screen-reader-text">toggle open/close sidebar</span>
                        <i class="icon-sidebar"></i>
                        <i class="icon-close"></i>
                    </button>
                </div>
                <div class="sidebar-hide-scroll">

                    <aside id="secondary" class="widget-area" role="complementary">
                        <section id="text-2" class="widget widget_text">
                            <div class="textwidget">
                                <h3>Hi, Iâ€™m Geoffrey!</h3>
                                <p>Here, you can read about my adventures with Machine Learning, Deep Learning, Data Visualization &amp; JavaScript!</p>
                            </div>
                        </section>

                        <section id="nav_menu-2" class="widget widget_nav_menu">
                            <div class="menu-social-menu-container">
                                <ul id="menu-social-menu" class="menu">
                                    <li id="menu-item-70" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-70"><a href="https://www.linkedin.com/in/geoffreysaxena/">LinkedIn</a></li>
                                    <li id="menu-item-71" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-71"><a href="https://github.com/geoffreysaxena">GitHub</a></li>
                                    <li id="menu-item-72" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-72"><a href="https://public.tableau.com/profile/saxenageoffrey#!/">Tableau</a></li>
                                    <li id="menu-item-73" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-73"><a href="https://twitter.com/geoffrey_saxena">Twitter</a></li>
                                    <li id="menu-item-74" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-74"><a href="https://in.pinterest.com/Geffyy/">Pinterest</a></li>
                                </ul>
                            </div>
                        </section>

                        <section id="recent-posts-2" class="widget widget_recent_entries">
                            <h2 class="widget-title"><b>Recent Posts</b></h2>
                            <ul>
                                <li>
                                    <a href="../who-said-mathematics-isn't-beautiful/who-said-mathematics-isn't-beautiful.html">Who Said Mathematics Isn't Beautiful?</a>
                                </li>
                                <li>
                                    <a href="../classifying-doodles-with-javascript/classifying-doodles-with-javascript.html">Classifying Doodles with JavaScript</a>
                                </li>
                                <li>
                                    <a href="../dog-breed-classification-using-cnns/dog-breed-classification-using-cnns.html">Dog Breed Classification using CNN's</a>
                                </li>
                                <li>
                                    <a href="../compose-a-poem-using-nlp-and-bert/compose-a-poem-using-nlp-and-bert.html">Compose A Poem using NLP &amp; BERT</a>
                                </li>
                                <li>
                                    <a href="../the-one-where-i-visualize-the-friends-screen-time/the-one-where-i-visualize-the-friends-screen-time.html">The One Where I Visualize The FRIENDS Screen Time</a>
                                </li>
                            </ul>
                        </section>

                        <section id="categories-2" class="widget widget_categories">
                            <h2 class="widget-title"><b>Categories</b></h2>
                            <ul>
                                <li class="cat-item cat-item-8"><a href="../category/machine-learning/index.html">Machine Learning</a>
                                </li>
                                <li class="cat-item cat-item-7"><a href="../category/data-visualization/index.html">Data Visualization</a>
                                </li>
                                <li class="cat-item cat-item-4"><a href="../category/javascript/index.html">JavaScript</a>
                                </li>
                                <li class="cat-item cat-item-4"><a href="../category/makeovermonday/index.html">MakeoverMonday</a>
                                </li>
                                <li class="cat-item cat-item-4"><a href="../category/coding-challenges/index.html">Coding Challenges</a>
                                </li>
                            </ul>
                        </section>
                    </aside><!-- #secondary -->
                </div>

                <div class="main-navigation-center clear">
                    <nav id="site-navigation" class="main-navigation" role="navigation">
                        <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                            <p class="open-menu">Menu</p>
                            <p class="close-menu"><i class="icon-close"></i>Close</p>
                        </button>

                        <div class="menu-menu-container">
                            <ul id="primary-menu" class="menu">
                                <li id="menu-item-14" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-14"><a href="../index.html">Home</a></li>
                                <li id="menu-item-22" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-22"><a href="../category/index.html">Categories</a>
                                    <ul class="sub-menu">
                                        <li id="menu-item-23" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-23"><a href="../category/machine-learning/index.html">Machine Learning</a></li>
                                        <li id="menu-item-24" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-24"><a href="../category/data-visualization/index.html">Data Visualization</a></li>
                                        <li id="menu-item-25" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-25"><a href="../category/javascript/index.html">JavaScript</a></li>
                                        <li id="menu-item-26" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-26"><a href="../category/makeovermonday/index.html">MakeoverMonday</a></li>
                                        <li id="menu-item-27" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-27"><a href="../category/coding-challenges/index.html">Coding Challenges</a></li>
                                    </ul>
                                </li>

                                <li id="menu-item-31" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-31"><a href="../playground/index.html">Playground</a></li>
                                <li id="menu-item-15" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-15"><a href="../about/index.html" aria-current="page">About</a></li>
                                <li id="menu-item-16" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16"><a href="../contact/index.html">Contact</a></li>
                            </ul>
                        </div>
                    </nav><!-- #site-navigation -->
                </div>
            </div>


            <div id="content" class="site-content">

                <div id="primary" class="content-area container container-wrapper">
                    <main id="main" class="site-main" role="main">


                        <article id="post-129" class="container container-medium post-129 post type-post status-publish format-standard has-post-thumbnail hentry category-dairy-free-recipes category-easy-dinner-ideas category-recipes">



                            <div class="featured-content featured-image">
                                <img width="800" height="1200" src="../images/image-classify.jpg" class="attachment-collecto-single-post size-collecto-single-post wp-post-image" alt="" loading="lazy"/>
                            </div>


                            <header class="entry-header">
                                <h1 class="entry-title">Image Classification with MobileNet</h1>
                            </header><!-- .entry-header -->


                            <aside class="meta-author">
                                <div class="entry-meta">
                                    <div class="posted-on">
                                        <p class="entry-date">Posted on</p>
                                        <p><span class="entry-date"><a href="index.html" rel="bookmark"><time class="entry-date published" datetime="2019-09-03T10:35:36+00:00">September 3, 2019</time></a></span></p>
                                    </div>
                                </div>
                                <section class="author-box">
                                    <div class="author-avatar">
                                        <img alt='' src='../images/geffy.jpg' class='avatar avatar-150 photo' height='150' width='150' loading='lazy' />
                                    </div>
                                    <div class="author-info">
                                        <p>In here, you can read about my adventures with Machine, Deep Learning, Data Visualization &amp; JavaScript!</p>
                                    </div>
                                </section>
                            </aside>

                            <nav class="navigation posts-navigation" role="navigation" aria-label="Posts navigation">
                                <h2 class="screen-reader-text">Posts navigation</h2>
                                <div class="nav-links">
                                    <div class="nav-previous"><a href="../compose-a-poem-using-nlp-and-bert/compose-a-poem-using-nlp-and-bert.html"><span class="prev-trig"><i class="icon-left"></i>Previous</span>
                                            <div class="prev-title"><span style="font-size: 20px" class="post-title">Compose A Poem using NLP &amp; BERT</span></div>
                                        </a></div>
                                    <div class="nav-next"><a href="../the-one-where-i-visualize-the-friends-screen-time/the-one-where-i-visualize-the-friends-screen-time.html"><span class="next-trig">Next<i class="icon-right"></i></span>
                                            <div class="next-title"><span style="font-size: 20px" class="post-title">The One Where I Visualize The FRIENDS Screen Time</span></div>
                                        </a></div>
                                </div>
                            </nav>
                            <div class="entry-content container container-xs">

                                <p>
                                    So, this is my starter code, we have two files, namely index.html &amp; sketch.js.
                                    Moving on to the HTML file:
                                </p>

                                <p>
                                    <b>index.html</b><br>
                                <figure class="highlight">
                                    <pre><span class="p">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.2.0/p5.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://unpkg.com/ml5@latest/dist/ml5.min.js">&lt;/script&gt;
    &lt;link rel="stylesheet" type="text/css" href="style.css">
    &lt;meta charset="utf-8" />

&lt;/head&gt;

&lt;body&gt;
    &lt;script src="sketch.js"&gt;&lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</span></pre>
                                </figure>

                                <b>sketch.js</b><br>
                                <figure class="highlight">
                                    <pre><span class="p">function setup() {
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    I have imported the ml5 library &amp; the p5 library, Iâ€™m running the latest version as of writing this blog (p5.js â€“ 1.2.0).
                                </p>

                                <p>
                                    Letâ€™s start by creating two variables, one for our model &amp; the other to store our image.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">let mobilenet;
let myimage;</span></pre>
                                </figure>
                                </p>


                                <p>
                                    Now we move on to create the setup function. Here, we draw the canvas using the create canvas functions, set the background to black by using the background parameter.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">let canvas;
function setup() {
  canvas = createCanvas(400, 400);
  background(255);
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Once weâ€™re done with this, weâ€™ll initialize our mobile net model by calling the Image Classifier, and passing it two arguments i.e., the model name â€˜MobileNetâ€™ and the modelReady function.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">function setup() {
  canvas = createCanvas(400, 400);
  background(255);
  mobilenet = ml5.imageClassifier('MobileNet', modelReady)
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Then weâ€™ll proceed to create a function thatâ€™ll let us know once our model is ready, and once it does itâ€™ll just log it into the console log.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">function modelReady() {
  console.log('The model is loaded! ðŸš€');
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Finally, we can start classifying our images, letâ€™s create a function to create an image and pass it to our image. To render the image on our canvas we use the image hide function.
                                </p>

                                <p>
                                    Now images donâ€™t render instantly in our browser, weâ€™ve got to wait for that to happen.
                                </p>

                                <p>
                                    To do this, weâ€™ll just create a call back function and pass it to our create image function, and name it imageReady.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">function setup() {
  canvas = createCanvas(400, 400);
  myimage = createImg('images/my_img.jpg', imageReady);
  myimage.hide();
  background(255);
  mobilenet = ml5.imageClassifier('MobileNet', modelReady)
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Now weâ€™ll create our imageReady function, here we draw the image into our canvas by passing it the x, y, width, height values as parameters.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">function imageReady() {
  image(myimage, 0, 0, width, height);
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Running this piece of code renders or draws our image on our canvas.
                                </p>

                                <p>
                                    Once weâ€™re finished with this we move on to create our predict function, again this doesnâ€™t happen instantaneously too so we need to provide it with a callback function that weâ€™ll name gotResults.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">function modelReady() {
  console.log('The model is loaded! ðŸš€');
  mobilenet.predict(myimage, gotResults);
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Letâ€™s create our callback function, which we named gotResults.
                                    So, we create a function, and pass it two arguments, first the error &amp; then the results as ml5 follows an error first callback mechanism.
                                </p>

                                <p>
                                    We just handle the error by logging in into the console &amp; move on.
                                    To display the results on the HTML page rather than in the console log we can do the following, extract the label and the probability from the results array and create separate elements for it that weâ€™ll then display on the page.
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">function gotResults(error, results) {
  if (error) {
    console.error(error);
  } else {
    console.log(results);
    let label = results[0].className;
    let prob = results[0].probability;
    fill(0);
    textSize(64);
    text(label, 10, height - 100);
    createP(label);
    createP(prob);
  }
}</span></pre>
                                </figure>
                                </p>

                                <p>
                                    Combine all the code snippets and your sketch.js file should look something like this:
                                </p>

                                <p>
                                <figure class="highlight">
                                    <pre><span class="p">let mobilenet;
let puffin;

function modelReady() {
  console.log('The model is loaded! ðŸš€');
  mobilenet.predict(myimage, gotResults);
}

function gotResults(error, results) {
  if (error) {
    console.error(error);
  } else {
    console.log(results);
    let label = results[0].className;
    let prob = results[0].probability;
    fill(0);
    textSize(64);
    text(label, 10, height - 100);
    createP(label);
    createP(prob);
  }
}

function imageReady() {
  image(myimage, 0, 0, width, height);
}

function setup() {
  canvas = createCanvas(400, 400);
  myimage = createImg('images/my_img.jpg', imageReady);
  myimage.hide();
  background(255);
  mobilenet = ml5.imageClassifier('MobileNet', modelReady)
}
</span></pre>
                                </figure>
                                </p>

                            </div><!-- .entry-content -->


                        </article><!-- #post-## -->

                    </main><!-- #main -->

                </div><!-- #primary -->


            </div><!-- #content -->

            <footer class="d-flex pb-5 pt-6 pt-md-4 border-top border-light bg-primary">
                <div class="container">
                    <div class="row text-center">
                        <div class="col-lg-12">
                            <div class="social m-0">
                                <li class="social__item">
                                    <a class="social__link" href="https://github.com/geoffreysaxena" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:github" data-inline="false"></span>
                                    </a>
                                </li>

                                <li class="social__item">
                                    <a class="social__link" href="https://www.linkedin.com/in/geoffreysaxena/" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:linkedin-rect" data-inline="false"></span>
                                    </a>
                                </li>



                                <li class="social__item">
                                    <a class="social__link" href="https://public.tableau.com/profile/saxenageoffrey#!/" target="_blank" rel="noopener"><span class="iconify" data-icon="cib:tableau" data-inline="false"></span>
                                    </a>
                                </li>

                                <li class="social__item">
                                    <a style="--ionicon-stroke-width: 64px" class="social__link" href="https://twitter.com/geoffrey_saxena" target="_blank" rel="noopener"><span class="iconify" data-icon="el:twitter" data-inline="false"></span>
                                    </a>
                                </li>
                                <li class="social__item">
                                    <a style="--ionicon-stroke-width: 128px" class="social__link" href="https://in.pinterest.com/Geffyy/" target="_blank" rel="noopener"><span class="iconify" data-icon="simple-icons:pinterest" data-inline="false"></span>
                                    </a>
                                </li>
                            <br><br>
                            <a>Hosted by Pratik Geoffrey Saxena</a>
                            </div>
                        </div>
                    </div>
                </div>
            </footer><!-- #colophon -->
        </div><!-- #page -->
        <span class="black-overlay"></span>
        <script src="../js/wpmin.js" data-minify="1" defer></script>
    </body>
</body>

</html>